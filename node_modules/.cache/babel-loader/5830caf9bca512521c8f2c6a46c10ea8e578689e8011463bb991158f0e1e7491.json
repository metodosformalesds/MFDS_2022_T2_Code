{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Viane/OneDrive/Desktop/vetLogin/vetlogin_react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Viane/OneDrive/Desktop/vetLogin/vetlogin_react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Viane/OneDrive/Desktop/vetLogin/vetlogin_react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,createContext}from\"react\";import{setToken,getToken,removeToken}from\"../api/token\";import{useUser}from\"../hooks\";//useState, useEffect,\nimport{jsx as _jsx}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext({auth:undefined,login:function login(){return null;},logout:function logout(){return null;}});export function AuthProvider(props){var children=props.children;var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),auth=_useState2[0],setAuth=_useState2[1];var _useUser=useUser(),getMe=_useUser.getMe;useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,me;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=getToken();if(!token){_context.next=8;break;}_context.next=4;return getMe(token);case 4:me=_context.sent;setAuth({token:token,me:me});_context.next=9;break;case 8:setAuth(null);case 9:console.log(token);case 10:case\"end\":return _context.stop();}}},_callee);}))();},[]);var login=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(token){var me;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setToken(token);_context2.next=3;return getMe(token);case 3:me=_context2.sent;setAuth({token:token,me:me});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function login(_x){return _ref2.apply(this,arguments);};}();var logout=function logout(){if(auth){removeToken();setAuth(null);}};var valueContext={auth:auth,login:login,logout:logout};if(auth===undefined)return null;return/*#__PURE__*/_jsx(AuthContext.Provider,{value:valueContext,children:children});}","map":{"version":3,"names":["React","useState","useEffect","createContext","setToken","getToken","removeToken","useUser","AuthContext","auth","undefined","login","logout","AuthProvider","props","children","setAuth","getMe","token","me","console","log","valueContext"],"sources":["C:/Users/Viane/OneDrive/Desktop/vetLogin/vetlogin_react/src/context/AuthContext.js"],"sourcesContent":["import React, {useState,useEffect, createContext} from \"react\";\r\nimport {setToken, getToken, removeToken} from \"../api/token\";\r\nimport {useUser} from \"../hooks\";\r\n\r\n//useState, useEffect,\r\n\r\nexport const AuthContext = createContext({\r\n    auth: undefined,\r\n    login: () => null,\r\n    logout: ()=> null,\r\n});\r\n\r\nexport function AuthProvider(props){\r\n    const {children}=props;\r\n    const [auth, setAuth] = useState(undefined);\r\n    const {getMe}=useUser();\r\n\r\n    useEffect(() => {\r\n      (async()=>{\r\n        const token= getToken();\r\n        if(token){\r\n            const me =await getMe(token);\r\n            setAuth({token,me});\r\n        } else{\r\n            setAuth(null)\r\n        }\r\n        console.log(token);\r\n      })();\r\n    }, [])\r\n    \r\n\r\n    const login=async(token)=>{\r\n        setToken(token);\r\n        const me=await getMe(token);\r\n        setAuth({token, me});\r\n        \r\n    };\r\n    const logout=()=>{\r\n        if(auth){\r\n            removeToken();\r\n            setAuth(null);\r\n        }\r\n    }\r\n\r\n    const valueContext={\r\n        auth,\r\n        login,\r\n        logout,\r\n    };\r\n\r\n    if(auth=== undefined) return null;\r\n\r\n    return(\r\n        <AuthContext.Provider value={valueContext}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}"],"mappings":"ubAAA,MAAOA,MAAK,EAAGC,QAAQ,CAACC,SAAS,CAAEC,aAAa,KAAO,OAAO,CAC9D,OAAQC,QAAQ,CAAEC,QAAQ,CAAEC,WAAW,KAAO,cAAc,CAC5D,OAAQC,OAAO,KAAO,UAAU,CAEhC;AAAA,2CAEA,MAAO,IAAMC,YAAW,cAAGL,aAAa,CAAC,CACrCM,IAAI,CAAEC,SAAS,CACfC,KAAK,CAAE,uBAAM,KAAI,GACjBC,MAAM,CAAE,wBAAK,KAAI,EACrB,CAAC,CAAC,CAEF,MAAO,SAASC,aAAY,CAACC,KAAK,CAAC,CAC/B,GAAOC,SAAQ,CAAED,KAAK,CAAfC,QAAQ,CACf,cAAwBd,QAAQ,CAACS,SAAS,CAAC,wCAApCD,IAAI,eAAEO,OAAO,eACpB,aAAcT,OAAO,EAAE,CAAhBU,KAAK,UAALA,KAAK,CAEZf,SAAS,CAAC,UAAM,CACd,0DAAC,kJACOgB,KAAK,CAAEb,QAAQ,EAAE,KACpBa,KAAK,+CACYD,MAAK,CAACC,KAAK,CAAC,QAAtBC,EAAE,eACRH,OAAO,CAAC,CAACE,KAAK,CAALA,KAAK,CAACC,EAAE,CAAFA,EAAE,CAAC,CAAC,CAAC,6BAEpBH,OAAO,CAAC,IAAI,CAAC,QAEjBI,OAAO,CAACC,GAAG,CAACH,KAAK,CAAC,CAAC,uDACpB,IAAG,CACN,CAAC,CAAE,EAAE,CAAC,CAGN,GAAMP,MAAK,6FAAC,kBAAMO,KAAK,+HACnBd,QAAQ,CAACc,KAAK,CAAC,CAAC,uBACDD,MAAK,CAACC,KAAK,CAAC,QAArBC,EAAE,gBACRH,OAAO,CAAC,CAACE,KAAK,CAALA,KAAK,CAAEC,EAAE,CAAFA,EAAE,CAAC,CAAC,CAAC,wDAExB,kBALKR,MAAK,6CAKV,CACD,GAAMC,OAAM,CAAC,QAAPA,OAAM,EAAK,CACb,GAAGH,IAAI,CAAC,CACJH,WAAW,EAAE,CACbU,OAAO,CAAC,IAAI,CAAC,CACjB,CACJ,CAAC,CAED,GAAMM,aAAY,CAAC,CACfb,IAAI,CAAJA,IAAI,CACJE,KAAK,CAALA,KAAK,CACLC,MAAM,CAANA,MACJ,CAAC,CAED,GAAGH,IAAI,GAAIC,SAAS,CAAE,MAAO,KAAI,CAEjC,mBACI,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAEY,YAAa,UACrCP,QAAQ,EACU,CAE/B"},"metadata":{},"sourceType":"module","externalDependencies":[]}